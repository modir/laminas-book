<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://modir.github.io/uploads/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Uploading Files with Forms - Using Laminas Framework</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Uploading Files with Forms";
        var mkdocs_page_input_path = "uploads.md";
        var mkdocs_page_url = "/uploads/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Using Laminas Framework
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Preface</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../intro/">None</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../acknowledgments/">Acknowledgments</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../intro/">Introduction to Laminas Framework</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../skeleton/">Laminas Skeleton Application</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../operation/">Website Operation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../mvc/">Model-View-Controller</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../routing/">Routing</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../appearance/">Page Appearance and Layout</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../forms/">Collecting User Input with Forms</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../filters/">Transforming Input Data with Filters</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../validators/">Checking Input Data with Validators</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Uploading Files with Forms</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#about-http-file-uploads">About HTTP File Uploads</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#http-binary-transfer-encoding">HTTP Binary Transfer Encoding</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_files-super-global-array-in-php">$_FILES Super-Global Array in PHP</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#accessing-uploaded-files-in-laminas">Accessing Uploaded Files in Laminas</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#file-uploads-laminas-form-model">File Uploads &amp; Laminas Form Model</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#validating-uploaded-files">Validating Uploaded Files</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#filtering-uploaded-files">Filtering Uploaded Files</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#inputfilter-container-file-uploads">InputFilter Container &amp; File Uploads</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#fileinput">FileInput</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#executing-validators-before-filters">Executing Validators before Filters</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#controller-action-file-uploads">Controller Action &amp; File Uploads</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#example-image-gallery">Example: Image Gallery</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#adding-imageform-model">Adding ImageForm Model</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#adding-validation-rules-to-imageform-model">Adding Validation Rules to ImageForm Model</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#writing-imagemanager-service">Writing ImageManager Service</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#adding-imagecontroller">Adding ImageController</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#adding-upload-action-corresponding-view-template">Adding Upload Action &amp; Corresponding View Template</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#adding-index-action-corresponding-view-template">Adding Index Action &amp; Corresponding View Template</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#adding-file-action">Adding File Action</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#creating-factory-for-the-controller">Creating Factory for the Controller</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#registering-the-imagecontroller">Registering the ImageController</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#creating-route">Creating Route</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#results">Results</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../forms_advanced/">Advanced Usage of Forms</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../doctrine/">Database Management with Doctrine ORM</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../doctrine_migrations/">Database Migrations</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../modules/">Creating a New Module</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../session/">Working with Sessions</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../users/">User Management, Authentication and Access Filtering</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../roles/">Role-Based Access Control</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../devenv/">Appendix A. Configuring Web Development Environment</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../netbeans/">Appendix B. Introduction to PHP Development in NetBeans IDE</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../bootstrap/">Appendix C. Introduction to Twitter Bootstrap</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../doctrine_intro/">Appendix D. Introduction to Doctrine</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../ec2_tutorial/">Appendix E. Installing a Laminas Web Application to Amazon EC2</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Using Laminas Framework</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Uploading Files with Forms</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/modir/laminas-book/edit/main/docs/uploads.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="uploading-files-with-forms">Uploading Files with Forms</h1>
<p>In this chapter, you will learn about uploading files with forms. First, we will review the basic
theory like HTTP file upload capability and binary content transfer encoding, and then provide a
complete working Image Gallery example showing how to upload images to a web server.</p>
<p>Laminas components covered in this chapter:</p>
<table>
<thead>
<tr>
<th><em>Component</em></th>
<th><em>Description</em></th>
</tr>
</thead>
<tbody>
<tr>
<td>@<code>Laminas\Form</code></td>
<td>Contains base form model classes.</td>
</tr>
<tr>
<td>@<code>Laminas\Filter</code></td>
<td>Contains various filters classes.</td>
</tr>
<tr>
<td>@<code>Laminas\Validator</code></td>
<td>Implements various validator classes.</td>
</tr>
<tr>
<td>@<code>Laminas\InputFilter</code></td>
<td>Implements a container for filters/validators.</td>
</tr>
</tbody>
</table>
<h2 id="about-http-file-uploads">About HTTP File Uploads</h2>
<p>HTML forms have capability for uploading files of arbitrarily large size <sup id="fnref:rfc-1867"><a class="footnote-ref" href="#fn:rfc-1867">1</a></sup>.
The files are typically transmitted through HTTP POST method <sup id="fnref:get"><a class="footnote-ref" href="#fn:get">2</a></sup>.</p>
<p>By default, HTTP uses the <em>URL encoding</em> for transfers of form data, and you could
see how that encoding looks like in previous chapters. However, this encoding is inefficient for uploading large files,
since URL-encoding binary data dramatically increases the
length of the HTTP request. For the purpose of uploading files, it is instead recommended to use
the so called "binary transfer encoding" described in the next section.</p>
<h3 id="http-binary-transfer-encoding">HTTP Binary Transfer Encoding</h3>
<p>A simple HTML form capable of file uploads is shown in the code example below. The binary
encoding type is enabled by setting the <code>enctype</code> attribute of the form with the value
of "multipart/form-data":</p>
<pre><code class="language-html">&lt;form action=&quot;upload&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;
    &lt;input type=&quot;file&quot; name=&quot;myfile&quot;&gt;
    &lt;br/&gt;
    &lt;input type=&quot;submit&quot; name=&quot;Submit&quot;&gt;
&lt;/form&gt;
</code></pre>
<p>In line 1, we explicitly set form encoding (<code>enctype</code> attribute) to "multipart/form-data"
to utilize effective binary content transfer encoding for the form.</p>
<p>In line 2, we define an input field with type "file" and name "myfile". This input field
will allow site visitor to select the file for upload.</p>
<p>If you now save the above mentioned markup to an <em>.html</em> file and open it in your web browser,
you will see the page like in figure 10.1.</p>
<p><img alt="Figure 10.1. A simple HTML form capable of file upload" src="../images/uploads/html_upload_form.png" /></p>
<p>The file element has the <em>Browse...</em> button allowing to pick a file for upload.
When the site user picks some file and clicks the <em>Submit</em> button on the form, the web browser will send
an HTTP request to the web server, and the request will contain the data of the file being uploaded.
The example below illustrates how the HTTP request may look like:</p>
<pre><code class="language-text">POST http://localhost/upload HTTP/1.1
Host: localhost
Content-Length: 488
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64)
Content-Type: multipart/form-data; boundary=----j1bOrwgLvOC3dy7o
Accept-Encoding: gzip,deflate,sdch

------j1bOrwgLvOC3dy7o
Content-Disposition: form-data; name=&quot;myfile&quot;; filename=&quot;Somefile.txt&quot;
Content-Type: text/html

(file binary data goes here)
------j1bOrwgLvOC3dy7o
Content-Disposition: form-data; name=&quot;Submit&quot;

Submit Request
------j1bOrwgLvOC3dy7o--
</code></pre>
<p>As you can see from the example above, the HTTP request with "multipart/form-data" encoding type
looks analogous to a usual HTTP request (has the status line, the headers, and the content area),
however it has the following important differences:</p>
<ul>
<li>
<p>Line 5 sets the "Content-Type" header with "multipart/form-data" value; The form is assembled
  of the fields marked by the "boundary" -- a unique randomly generated sequence of characters
  delimiting form fields of each other.</p>
</li>
<li>
<p>Lines 8-17 represent the content of the HTTP request. The form fields are delimited by the "boundary"
  sequences (lines 8, 13, 17). The data of the file being uploaded are transmitted in binary format
  (line 12), and that allows to reduce the content size to its minimum.</p>
</li>
</ul>
<p>W&gt; By default, PHP engine's settings do not allow to upload large files (larger than 2MB). In order to upload
W&gt; large files, you may need to edit the <em>php.ini</em> configuration file and modify the <code>post_max_size</code>
W&gt; and <code>upload_max_filesize</code> parameters (please refer to <a href="#devenv">Appendix A. Configuring Web Development Environment</a> for information on how to do that).
W&gt; Setting these with <code>100M</code> allows to upload files up to 100 Mb in size, and this would typically be sufficient.
W&gt; If you plan to upload very large files up to 1 GB in size, than better set these with 1024M.
W&gt; Do not forget to restart your Apache Web Server after editing the configuration file.</p>
<h3 id="_files-super-global-array-in-php">$_FILES Super-Global Array in PHP</h3>
<p>When a site visitor uploads some files to your Apache Web Server, the files are placed to a temporary location
(usually to system temporary directory that is <em>/tmp</em> in Linux and <em>C:\Windows\Temp</em> in Windows).
The PHP script receives the file information to the special super-global array named <code>$_FILES</code>.</p>
<blockquote>
<p>The <code>$_FILES</code> array is analogous to the <code>$_GET</code> and <code>$_POST</code> super-globals. The latter two
are used to store the GET and POST variables, respectively, while the first one is used
to store information about uploaded files.</p>
</blockquote>
<p>For example, for the above mentioned simple upload form, the <code>$_FILES</code> super-global array will look
as follows (the output is generated with the <code>var_dump()</code> PHP function):</p>
<pre><code class="language-text">array (size=1)
    'myfile' =&gt;
        array (size=5)
            'name' =&gt; string 'somefile.txt' (length=12)
            'type' =&gt; string 'text/plain' (length=10)
            'tmp_name' =&gt; string '/tmp/phpDC66.tmp' (length=16)
            'error' =&gt; int 0
            'size' =&gt; int 18
</code></pre>
<p>As you can see from the example above, the <code>$_FILES</code> array contains an entry per
each uploaded file. For each uploaded file, it contains the following information:</p>
<ul>
<li><code>name</code> -- original file name (line 4).</li>
<li><code>type</code> -- MIME <sup id="fnref:mime"><a class="footnote-ref" href="#fn:mime">3</a></sup> type of the file (line 5).</li>
<li><code>tmp_name</code> -- temporary name for the uploaded file (line 6).</li>
<li><code>error</code> -- error code signalling about the status of the upload (line 7);
     error code zero means the file was uploaded correctly.</li>
<li><code>size</code> -- file size in bytes (line 8).</li>
</ul>
<p>PHP engine stores the uploaded files in a temporary location which is cleaned up as soon as the PHP
script execution ends. So, if you want to save the uploaded files to some directory for later use,
you need to utilize the <code>move_uploaded_file()</code> PHP function. The <code>move_uploaded_file()</code> function
takes two arguments: the first one is the name of the temporary file, and the second one is the
destination file name.</p>
<blockquote>
<p>You might be confused why you cannot use the usual <code>rename()</code> PHP function for moving the
temporary uploaded file to its destination path. PHP has special function for moving
uploaded files for security reasons. The <code>move_uploaded_file()</code> function is analogous to
<code>rename()</code> function, but it takes some additional checks to ensure the file was really transferred
through HTTP POST request, and that the upload process has finished without errors.</p>
</blockquote>
<p>The following code example shows how to move the file uploaded with the
simple form we have considered above:</p>
<pre><code class="language-php">$destPath = '/path/to/your/upload/dir';
$result = move_uploaded_file($_FILES['myfile']['tmp_name'], $destPath);
if(!$result) {
    // Some error occurred.
}
</code></pre>
<p>Above, in line 1, we set the <code>$destPath</code> with the directory name where to save the
uploaded file.</p>
<p>In line 2, we call the <code>move_uploaded_file()</code> function and pass it two arguments: the path to the
temporary file and the destination path.</p>
<blockquote>
<p>Specifying the directory name as the second argument of the <code>move_uploaded_file()</code> function
is suitable when you do not want to rename the file. If you need to save the uploaded file
under another name than its original name, you can specify the full file path instead of the directory name.</p>
</blockquote>
<p>In line 3, we check the returned value of the function. If the operation is successful,
the function will return <code>true</code>. If some error occurs (for example, if directory permissions
are insufficient to save the file), the boolean <code>false</code> will be returned.</p>
<h2 id="accessing-uploaded-files-in-laminas">Accessing Uploaded Files in Laminas</h2>
<p>In your controller class, you typically do not communicate with the <code>$_FILES</code>
array directly, instead you may use the @<code>Request</code>[Laminas\Http\Request] class or the @<code>Params</code>
controller plugin, as shown in code example below:</p>
<pre><code class="language-php">&lt;?php
//...
class IndexController extends AbstractActionController
{
    // An example controller action intended for handling file uploads.
    public function uploadAction()
    {
        // Get the whole $_FILES array.
        $files = $this-&gt;getRequest()-&gt;getFiles();

        // The same, but with Params controller plugin.
        $files = $this-&gt;params()-&gt;fromFiles();

        // Get a single entry of the $_FILES array.
        $files = $this-&gt;params()-&gt;fromFiles('myfile');
  }
}
</code></pre>
<p>In line 9 of the code above, we use the <code>getRequest()</code> method of the controller class for accessing
the @<code>Request</code>[Laminas\Http\Request] object, and the <code>getFiles()</code> method of the request object to retrieve the information about
all upload files at once.</p>
<p>In line 12, we do the same thing with the @<code>Params</code> controller plugin. We use its <code>fromFiles()</code> method
to get the information about all uploaded files.</p>
<p>If needed, you can extract the information for the specific file only. In line 15, we use the same
<code>fromFiles()</code> method and pass it the name of the file field to retrieve. This retrieves the single
file entry from the <code>$_FILES</code> super-global array.</p>
<h2 id="file-uploads-laminas-form-model">File Uploads &amp; Laminas Form Model</h2>
<p>To add file uploading capability to your form model, you need to add an element
of the @<code>Laminas\Form\Element\File</code> class as follows:</p>
<pre><code class="language-php">    // Add the following code inside of form's addElements() method.

    // Add the &quot;file&quot; field.
    $this-&gt;add([
        'type'  =&gt; 'file',
        'name' =&gt; 'file',
        'attributes' =&gt; [
            'id' =&gt; 'file'
        ],
        'options' =&gt; [
            'label' =&gt; 'Upload file',
        ],
    ]);
</code></pre>
<p>In the code above, we call the <code>add()</code> method provided by the @<code>Form</code>[Laminas\Form\Form] base
class and pass it the configuration array describing the element. The
<code>type</code> key of the array (line 5) must be either @<code>Laminas\Form\Element\File</code>
class name or its short alias "file".</p>
<h2 id="validating-uploaded-files">Validating Uploaded Files</h2>
<p>Uploaded files need to be checked for correctness as any other form data. For example,
you may need to check that:</p>
<ul>
<li>
<p>the file(s) were really uploaded through HTTP POST request, and were not just copied from some directory;</p>
</li>
<li>
<p>the file(s) were uploaded successfully (the error code is zero);</p>
</li>
<li>
<p>the file names and/or extensions are acceptable (e.g., you may want to save JPEG files only, and reject all others);</p>
</li>
<li>
<p>the file size lies in the allowed range (e.g., you may want to ensure that the file is not too big);</p>
</li>
<li>
<p>total count of uploaded files doesn't exceed some allowed limit.</p>
</li>
</ul>
<p>For doing the checks like above, Laminas provides a number of useful file validators (listed in table 10.1).
Those validator classes belong to @<code>Laminas\Validator</code> component and live in @<code>Laminas\Validator\File</code>[Laminas\Validator] namespace.</p>
<table>
<thead>
<tr>
<th><em>Class name</em></th>
<th><em>Short alias</em></th>
<th><em>Description</em></th>
</tr>
</thead>
<tbody>
<tr>
<td>@<code>Count</code></td>
<td><code>FileCount</code></td>
<td>Checks whether the file count is in a given range (min, max).</td>
</tr>
<tr>
<td>@<code>WordCount</code></td>
<td><code>FileWordCount</code></td>
<td>Calculates the number of words in a file and checks whether it lies in a given range.</td>
</tr>
<tr>
<td>@<code>Upload</code></td>
<td><code>FileUpload</code></td>
<td>Performs security checks ensuring that all given files were really uploaded through HTTP POST and there were no upload errors.</td>
</tr>
<tr>
<td>@<code>UploadFile</code></td>
<td><code>FileUploadFile</code></td>
<td>Performs security checks ensuring that a file really was uploaded through HTTP POST and there were no upload errors.</td>
</tr>
<tr>
<td>@<code>Size</code></td>
<td><code>FileSize</code></td>
<td>Checks whether the file size lies in a given range.</td>
</tr>
<tr>
<td>@<code>FilesSize</code></td>
<td><code>FileFilesSize</code></td>
<td>Checks that the summary size of all given files lies in a given range.</td>
</tr>
<tr>
<td>@<code>Extension</code></td>
<td><code>FileExtension</code></td>
<td>Checks that the extension of a file belongs to a set of allowed extensions.</td>
</tr>
<tr>
<td>@<code>ExcludeExtension</code></td>
<td><code>FileExcludeExtension</code></td>
<td>Checks that the extension of a file DOES NOT belong to a set of extensions.</td>
</tr>
<tr>
<td>@<code>MimeType</code></td>
<td><code>FileMimeType</code></td>
<td>Checks that the MIME type of a file belongs to the list of allowed MIME types.</td>
</tr>
<tr>
<td>@<code>ExcludeMimeType</code></td>
<td><code>FileExcludeMimeType</code></td>
<td>Checks that the MIME type of a file DOES NOT belong to the list of MIME types.</td>
</tr>
<tr>
<td>@<code>IsImage</code></td>
<td><code>FileIsImage</code></td>
<td>Checks that the file is a graphical image (JPEG, PNG, GIF, etc.)</td>
</tr>
<tr>
<td>@<code>ImageSize</code></td>
<td><code>FileImageSize</code></td>
<td>Checks that the image file's dimensions lie in a given range.</td>
</tr>
<tr>
<td>@<code>Exists</code></td>
<td><code>FileExists</code></td>
<td>Checks whether the file exists on disk.</td>
</tr>
<tr>
<td>@<code>NotExists</code></td>
<td><code>FileNotExists</code></td>
<td>Checks whether the file doesn't exist on disk.</td>
</tr>
<tr>
<td>@<code>IsCompressed</code></td>
<td><code>FileIsCompressed</code></td>
<td>Checks that the file is an archive (ZIP, TAR, etc.)</td>
</tr>
<tr>
<td>@<code>Hash</code>[Laminas\Validator\File\Hash]</td>
<td><code>FileHash</code></td>
<td>Checks that the file content matches the given hash(es).</td>
</tr>
<tr>
<td>@<code>Crc32</code></td>
<td><code>FileCrc32</code></td>
<td>Checks that the file content has the given CRC32 check sum.</td>
</tr>
<tr>
<td>@<code>Sha1</code></td>
<td><code>FileSha1</code></td>
<td>Checks that the file content has the given SHA-1 hash.</td>
</tr>
<tr>
<td>@<code>Md5</code></td>
<td><code>FileMd5</code></td>
<td>Checks that the file content has the given MD5 hash.</td>
</tr>
</tbody>
</table>
<p>Table 10.1. Standard File Validators</p>
<p>As you can see from the table above, file validators may be roughly divided in the following groups:</p>
<ul>
<li>validators checking whether the file(s) were really uploaded through HTTP POST and upload status is OK;</li>
<li>validators checking the uploaded file count and file size;</li>
<li>validators checking the file extension and MIME type;</li>
<li>validators checking whether the file is a graphical image and checking image dimensions;</li>
<li>and validators checking the file hash (or check sum) <sup id="fnref:hash"><a class="footnote-ref" href="#fn:hash">4</a></sup>.</li>
</ul>
<blockquote>
<p>Please note that since file validators live in @<code>Laminas\Validator\File</code>[Laminas\Validator] namespace, their short aliases
(that you use when creating a validator with the factory) start with <code>File</code> prefix. For example,
the @<code>IsImage</code> validator has <code>FileIsImage</code> alias.</p>
</blockquote>
<p>We will show how to use some of these file validators in the <em>Image Gallery</em>
code example later in this chapter.</p>
<h2 id="filtering-uploaded-files">Filtering Uploaded Files</h2>
<p>Laminas Framework provides several filters intended for "transforming" file fields. Those filter
classes (listed in table 10.2) belong to @<code>Laminas\Filter</code> component and live in @<code>Laminas\Filter\File</code>[Laminas\Filter] namespace.</p>
<table>
<thead>
<tr>
<th><em>Class name</em></th>
<th><em>Short alias</em></th>
<th><em>Description</em></th>
</tr>
</thead>
<tbody>
<tr>
<td>@<code>Rename</code></td>
<td><code>FileRename</code></td>
<td>Renames/moves an arbitrary file.</td>
</tr>
<tr>
<td>@<code>RenameUpload</code></td>
<td><code>FileRenameUpload</code></td>
<td>Renames/moves the uploaded file with security checks.</td>
</tr>
<tr>
<td>@<code>Encrypt</code>[Laminas\Filter\File\Encrypt]</td>
<td><code>FileEncrypt</code></td>
<td>Encrypts a given file and stores the encrypted file content.</td>
</tr>
<tr>
<td>@<code>Decrypt</code>[Laminas\Filter\File\Decrypt]</td>
<td><code>FileDecrypt</code></td>
<td>Decrypts a given file and stores the decrypted file content.</td>
</tr>
<tr>
<td>@<code>LowerCase</code></td>
<td><code>FileLowerCase</code></td>
<td>Converts file content to lower case letters.</td>
</tr>
<tr>
<td>@<code>UpperCase</code></td>
<td><code>FileUpperCase</code></td>
<td>Converts file content to upper case letters.</td>
</tr>
</tbody>
</table>
<p>Table 10.2. Standard File Filters</p>
<p>From the table, you can see that filters can be divided into the following groups:</p>
<ul>
<li>filters for moving uploaded files from a temporary location to their persistent directory;</li>
<li>filters for encryption and decryption of files;</li>
<li>filters for converting text files to upper-case and lower-case letters.</li>
</ul>
<blockquote>
<p>Please note that since file filters live in @<code>Laminas\Filter\File</code>[Laminas\Filter] namespace, their short aliases
(that you use when creating a filter with the factory) start with <code>File</code> prefix. For example,
the @<code>RenameUpload</code> filter has <code>FileRenameUpload</code> alias.</p>
</blockquote>
<p>The @<code>Encrypt</code>[Laminas\Filter\File\Encrypt] and @<code>Decrypt</code>[Laminas\Filter\File\Decrypt] filters allow to apply various encryption/decryption algorithms
to the uploaded file (concrete algorithm is attached by specifying the certain adapter). The @<code>LowerCase</code> and
@<code>UpperCase</code> filters are suitable for converting text files to lower- and upper-case, respectively <sup id="fnref:four"><a class="footnote-ref" href="#fn:four">5</a></sup>.</p>
<p>The @<code>Rename</code> filter allows to rename and/or move an arbitrary file (not only uploaded file).
It uses the <code>rename()</code> PHP function internally, and that's why it is in general not recommended
to use this filter with uploaded files because of security reasons.</p>
<p>The @<code>RenameUpload</code> filter seems to be much more useful than other filters, because it allows to encapsulate
the call of the <code>move_uploaded_file()</code> function and move/rename the uploaded file from a temporary location
to its persistent directory. We will show how to use the @<code>RenameUpload</code> filter in the <em>Image Gallery</em>
code example later in this chapter.</p>
<h2 id="inputfilter-container-file-uploads">InputFilter Container &amp; File Uploads</h2>
<p>As you might remember, the filters and validators attached to a form model are typically
stored in an @<code>InputFilter</code>[Laminas\InputFilter\InputFilter] container which consists of <em>inputs</em> (an input is typically represented
by the @<code>Input</code>[Laminas\InputFilter\Input] class belonging to the @<code>Laminas\InputFilter</code> namespace). For usual form fields, the filters
are executed <em>before</em> validators, and validators are executed <em>after</em> filters.</p>
<p>However, for file uploads, there are some important differences:</p>
<ol>
<li>for storing validation rules for uploaded files, a special class called @<code>FileInput</code>
     should be utilized instead of the @<code>Input</code>[Laminas\InputFilter\Input] class;</li>
<li>and, validators are applied <em>before</em> filters (!).</li>
</ol>
<h3 id="fileinput">FileInput</h3>
<p>For storing validation rules for uploaded files, you must use the @<code>FileInput</code> class instead of the
usual @<code>Input</code>[Laminas\InputFilter\Input] class.</p>
<p>In your form model's <code>addInputFilter()</code> private method, you add the validation rules for the
file input as follows:</p>
<pre><code class="language-php">    $inputFilter-&gt;add([
        'type'     =&gt; 'Laminas\InputFilter\FileInput',
        'name'     =&gt; 'file',  // Element's name.
        'required' =&gt; true,    // Whether the field is required.
        'filters'  =&gt; [        // Filters.
            // Put filter info here.
        ],
        'validators' =&gt; [      // Validators.
            // Put validator info here.
        ]
    ]);
</code></pre>
<p>Above, we set the "type" key (line 2) with the value @<code>Laminas\InputFilter\FileInput</code> class name. The
rest of keys is analogous to those we used before when adding validation rules for a form model.</p>
<p>The behaviour of @<code>FileInput</code> class differs from the @<code>Input</code>[Laminas\InputFilter\Input] in the following aspects:</p>
<ol>
<li>
<p>It expects the data you pass as input to be in the <code>$_FILES</code> array format (an array entry with
    <code>tmp_name</code>, <code>error</code>, <code>type</code> keys).</p>
</li>
<li>
<p>A @<code>Laminas\Validator\File\Upload</code> validator is automatically inserted before all other validators
    into the validator chain of the input.</p>
</li>
<li>
<p>The validators inserted to the validator chain of the input are executed <em>before</em> the
    filters inserted into its filter chain. This is opposite to the behaviour of the @<code>Input</code>[Laminas\InputFilter\Input] class.</p>
</li>
</ol>
<h3 id="executing-validators-before-filters">Executing Validators before Filters</h3>
<p>For usual form fields, the filters are typically executed <em>before</em> validators, and validators are
executed <em>after</em> filters. However, for file uploads, this sequence is opposite.</p>
<blockquote>
<p>For file uploads, validators are executed <em>before</em> filters. This behaviour is inverse to the usual
behaviour.</p>
</blockquote>
<p>When working with uploaded files, we first need to check that data extracted from <code>$_FILES</code>
super-global array is correct, and then do anything else with the files (moving the file into a
storage directory, renaming it, etc.) Because of that, file validators need to be run first turn, and
filters to be executed last.</p>
<p>To see how this is performed, recall the typical workflow for a form:</p>
<ul>
<li>First, we call the <code>setData()</code> method to fill in the form with data.</li>
<li>Call the <code>isValid()</code> method to execute filters and validators in the input filter attached to form.</li>
<li>On successful validation, call the <code>getData()</code> to extract the filtered and validated data from
   the input filter attached to form.</li>
<li>On failure, call the <code>getMessages()</code> to retrieve the validation error messages.</li>
</ul>
<p>When using a @<code>FileInput</code> input, the workflow is the same, however it is important to understand what
happens on each of its steps:</p>
<ul>
<li>Call the <code>setData()</code> method to fill in the form with data.</li>
<li>Call the <code>isValid()</code> method to <strong>execute validators</strong> in the input filter attached to form.</li>
<li>On successful validation, call the <code>getData()</code> to <strong>execute filters</strong> and extract the filtered
   and validated data from the input filter attached to form.</li>
<li>On failure, call the <code>getMessages()</code> to retrieve the validation error messages.</li>
</ul>
<blockquote>
<p>Please note that for @<code>FileInput</code> input, the attached filters are only run if the <code>getData()</code>
method is called.</p>
</blockquote>
<p>When you use both @<code>Input</code>[Laminas\InputFilter\Input] and @<code>FileInput</code> inputs in your form's input filter (which is a common case),
the filters are still executed first for usual inputs, but validators are executed first for file inputs.</p>
<h2 id="controller-action-file-uploads">Controller Action &amp; File Uploads</h2>
<p>In this section, we will provide a short code example showing how to handle file uploads in a
controller action method. We will attract reader's attention to the aspects specific to file uploads.</p>
<p>Assume we want to add a web page displaying a form (let's name it <code>YourForm</code>) capable of file uploads.
For that page, we need to add the <code>uploadAction()</code> method to a controller class:</p>
<pre><code class="language-php">&lt;?php
//...
class IndexController extends AbstractActionController
{
    // This is the &quot;upload&quot; action displaying the Upload page.
    public function uploadAction()
    {
        // Create the form model.
        $form = new YourForm();

        // Check if user has submitted the form.
        if($this-&gt;getRequest()-&gt;isPost()) {

            // Make certain to merge the files info!
            $request = $this-&gt;getRequest();
            $data = array_merge_recursive(
                $request-&gt;getPost()-&gt;toArray(),
                $request-&gt;getFiles()-&gt;toArray()
            );

            // Pass data to form.
            $form-&gt;setData($data);

            // Execute file validators.
            if($form-&gt;isValid()) {

                // Execute file filters.
                $data = $form-&gt;getData();

                // Redirect the user to another page.
                return $this-&gt;redirect()-&gt;toRoute('application', ['action'=&gt;'index']);
            }
        }

        // Render the page.
        return new ViewModel([
                 'form' =&gt; $form
            ]);
    }
}
</code></pre>
<p>As you can see from the code above, the <code>uploadAction()</code> looks like a usual controller action
implementing a typical form workflow, however it has some aspects specific to file uploads (marked
with <strong>bold</strong>):</p>
<ul>
<li>
<p>In line 9, we create an instance of the <code>YourForm</code> form model with the help of the <code>new</code> operator.</p>
</li>
<li>
<p>In line 12, we check whether the request is an HTTP POST request. If so, we <strong>get the data from <code>$_POST</code>
    and <code>$_FILES</code> super-global PHP arrays and merge them into the single array (lines 15-19). This is
    required to correctly handle uploaded files, if any. Then we pass this array to the form model with
    the <code>setData()</code> method (line 22)</strong>.</p>
</li>
<li>
<p>In line 25, we call the form model's <code>isValid()</code> method. This method runs the input filter attached
    to the form model. For @<code>FileInput</code> inputs, <strong>this will execute attached validators only</strong>.</p>
</li>
<li>
<p>If the data is valid, we call the <code>getData()</code> method (line 28). For the @<code>FileInput</code> inputs, this
    <strong>will run the attached file filters</strong>. The file filters, for example, could move the uploaded files
    to the directory of residence.</p>
</li>
<li>
<p>On success, in line 31, we redirect the user to the "index" action of the controller.</p>
</li>
</ul>
<blockquote>
<p>In the controller action above, you should remember three things: 1) merge <code>$_POST</code> and <code>$_FILES</code> super-global
arrays before you pass them to the form's <code>setData()</code> method; 2) use <code>isValid()</code> form's method to
check uploaded files for correctness (run validators); 3) use <code>getData()</code> form's method to run
file filters.</p>
</blockquote>
<h2 id="example-image-gallery">Example: Image Gallery</h2>
<p>To demonstrate the usage of file uploads in Laminas Framework, we will create an Image Gallery that
will consist of two web pages: the image upload page allowing to upload an image (figure 10.2); and
the gallery page containing the list of uploaded images (figure 10.3).</p>
<blockquote>
<p>You can see the working <em>Image Gallery</em> example in the <em>Form Demo</em> sample application
bundled with this book.</p>
</blockquote>
<p>{width=80%}
<img alt="Figure 10.2. Image Upload Page" src="../images/uploads/upload_image_form.png" /></p>
<p>{width=80%}
<img alt="Figure 10.3. Image Gallery Page" src="../images/uploads/image_gallery.png" /></p>
<p>For this example, we will create the following things:</p>
<ul>
<li>the <code>ImageForm</code> form model capable of image file uploads;</li>
<li>the <code>ImageManager</code> service class designed for getting the list of uploaded images, retrieving information about an image, and resizing an image;</li>
<li>the <code>ImageController</code> class which will contain action methods serving the web pages;</li>
<li>the <code>ImageControllerFactory</code> factory that will instantiate the controller and inject dependencies into it;</li>
<li>a view template <code>.phtml</code> file per each controller's action method.</li>
</ul>
<h3 id="adding-imageform-model">Adding ImageForm Model</h3>
<p>For this example, we will need a form model which will be used for image file uploads. We will call
that form model class the <code>ImageForm</code>. This class will allow us to upload an image file to the
server. The form will have the following fields:</p>
<ul>
<li>
<p>the <code>file</code> field will allow the user to pick an image file for upload;</p>
</li>
<li>
<p>and the <code>submit</code> button field allowing to send the form data to server.</p>
</li>
</ul>
<p>The code of the <code>ImageForm</code> form model is presented below. It should be put to <em>ImageForm.php</em> file
stored in <em>Form</em> directory under the module's source directory:</p>
<pre><code class="language-php">&lt;?php
namespace Application\Form;

use Laminas\Form\Form;

// This form is used for uploading an image file.
class ImageForm extends Form
{
    // Constructor.
    public function __construct()
    {
        // Define form name.
        parent::__construct('image-form');

        // Set POST method for this form.
        $this-&gt;setAttribute('method', 'post');

        // Set binary content encoding.
        $this-&gt;setAttribute('enctype', 'multipart/form-data');

        $this-&gt;addElements();
    }

    // This method adds elements to form.
    protected function addElements()
    {
        // Add &quot;file&quot; field.
        $this-&gt;add([
            'type'  =&gt; 'file',
            'name' =&gt; 'file',
            'attributes' =&gt; [
                'id' =&gt; 'file'
            ],
            'options' =&gt; [
                'label' =&gt; 'Image file',
            ],
        ]);

        // Add the submit button.
        $this-&gt;add([
            'type'  =&gt; 'submit',
            'name' =&gt; 'submit',
            'attributes' =&gt; [
                'value' =&gt; 'Upload',
                'id' =&gt; 'submitbutton',
            ],
        ]);
    }
}
</code></pre>
<p>We have already discussed the form model creation and the code above should not cause any problems
in its understanding. We just want to attract the attention of the reader that in line 19, we set
the "multipart/form-data" value for the "enctype" attribute of the form to make the form use binary
encoding for its data.</p>
<blockquote>
<p>Actually, explicitly setting the "enctype" attribute in form's constructor is optional, because
@<code>Laminas\Form\Element\File</code> element performs that automatically when you call form's <code>prepare()</code>
method.</p>
</blockquote>
<h3 id="adding-validation-rules-to-imageform-model">Adding Validation Rules to ImageForm Model</h3>
<p>To demonstrate the usage of validators and filters designed to work with file uploads, we will
add those to the <code>ImageForm</code> form model class. We want to achieve the following goals:</p>
<ul>
<li>check if the uploaded file really was uploaded through HTTP POST method using the @<code>UploadFile</code> validator;</li>
<li>check that the uploaded file is an image (JPEG, PNG, GIF, etc.) using the @<code>IsImage</code> validator;</li>
<li>check that image dimensions are within some allowed boundaries; we will do that with the @<code>ImageSize</code> validator;</li>
<li>move the uploaded file to its residence directory using the @<code>RenameUpload</code> filter.</li>
</ul>
<p>To add form validation rules, modify the code of the <code>ImageForm</code> class as follows:</p>
<pre><code class="language-php">&lt;?php
namespace Application\Form;

use Laminas\InputFilter\InputFilter;

// This form is used for uploading an image file.
class ImageForm extends Form
{
    // Constructor
    public function __construct()
    {
        // ...

        // Add validation rules
        $this-&gt;addInputFilter();
    }

    // ...

    // This method creates input filter (used for form filtering/validation).
    private function addInputFilter()
    {
        $inputFilter = new InputFilter();
        $this-&gt;setInputFilter($inputFilter);

        // Add validation rules for the &quot;file&quot; field.
        $inputFilter-&gt;add([
                'type'     =&gt; 'Laminas\InputFilter\FileInput',
                'name'     =&gt; 'file',
                'required' =&gt; true,
                'validators' =&gt; [
                    ['name'    =&gt; 'FileUploadFile'],
                    [
                        'name'    =&gt; 'FileMimeType',
                        'options' =&gt; [
                            'mimeType'  =&gt; ['image/jpeg', 'image/png']
                        ]
                    ],
                    ['name'    =&gt; 'FileIsImage'],
                    [
                        'name'    =&gt; 'FileImageSize',
                        'options' =&gt; [
                            'minWidth'  =&gt; 128,
                            'minHeight' =&gt; 128,
                            'maxWidth'  =&gt; 4096,
                            'maxHeight' =&gt; 4096
                        ]
                    ],
                ],
                'filters'  =&gt; [
                    [
                        'name' =&gt; 'FileRenameUpload',
                        'options' =&gt; [
                            'target' =&gt; './data/upload',
                            'useUploadName' =&gt; true,
                            'useUploadExtension' =&gt; true,
                            'overwrite' =&gt; true,
                            'randomize' =&gt; false
                        ]
                    ]
                ],
            ]);
    }
}
</code></pre>
<p>In the code above, we add the following file validators:</p>
<ul>
<li>
<p>@<code>UploadFile</code> validator (line 32) checks whether the uploaded file was really uploaded using
     the HTTP POST method.</p>
</li>
<li>
<p>@<code>MimeType</code> validator (line 34) checks whether the uploaded file is a JPEG or PNG image.
    It does that by extracting MIME information from file data.</p>
</li>
<li>
<p>@<code>IsImage</code> validator (line 39) checks whether the uploaded file is an image file (PNG, JPG,
     etc.). It does that by extracting MIME information from file data.</p>
</li>
<li>
<p>@<code>ImageSize</code>    validator (line 41) allows to check that image dimensions lie in an allowed range.
     In the code above, we check that the image is between 128 pixels and 4096 pixels in width, and
     that the image height lies between 128 pixels and 4096 pixels.</p>
</li>
</ul>
<p>In line 52, we add the @<code>RenameUpload</code> filter and configure it to save the uploaded file to
the <em>APP_DIR/data/upload</em> directory. The filter will use the same file name for the destination file
as the name of the original file (<code>useUploadName</code> option). If the file with such name already
exists, the filter will overwrite it (<code>overwrite</code> option).</p>
<p>W&gt; For the @<code>MimeType</code> and @<code>IsImage</code> validator to work, you have to enable PHP <code>fileinfo</code> extension. This extension
W&gt; is already enabled in Linux Ubuntu, but not in Windows. After that, do not forget to restart Apache HTTP Server.</p>
<h3 id="writing-imagemanager-service">Writing ImageManager Service</h3>
<p>Because we strive to write code conforming to Domain Driven Design pattern, we will
create a service model class encapsulating the functionality for image management. We will
call this class <code>ImageManager</code> and put it to <code>Application\Service</code> namespace. We will also
register this service in the service manager component of the web application.</p>
<p>The <code>ImageManager</code> service class will have the following public methods (listed in table 10.3):</p>
<table>
<thead>
<tr>
<th><em>Method</em></th>
<th><em>Description</em></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getSaveToDir()</code></td>
<td>Returns path to the directory where we save the image files.</td>
</tr>
<tr>
<td><code>getSavedFiles()</code></td>
<td>Returns the array of saved file names.</td>
</tr>
<tr>
<td><code>getImagePathByName($fileName)</code></td>
<td>Returns the path to the saved image file.</td>
</tr>
<tr>
<td><code>getImageFileInfo($filePath)</code></td>
<td>Retrieves the file information (size, MIME type) by image path.</td>
</tr>
<tr>
<td><code>getImageFileContent($filePath)</code></td>
<td>Returns the image file content. On error, returns boolean false.</td>
</tr>
<tr>
<td><code>resizeImage($filePath, $desiredWidth)</code></td>
<td>Resizes the image, keeping its aspect ratio.</td>
</tr>
</tbody>
</table>
<p>Table 10.3. Public methods of the ImageManager class.</p>
<blockquote>
<p>In fact, we could put the code we plan to add into the service into the controller actions, but that
would make the controller fat and poorly testable. By introducing the service class, we improve
the separation of concerns and code reusability.</p>
</blockquote>
<p>Add the <em>ImageManager.php</em> file to the <em>Service</em> directory under the module's
source directory. Add the following code to the file:</p>
<pre><code class="language-php">&lt;?php
namespace Application\Service;

// The image manager service.
class ImageManager
{
    // The directory where we save image files.
    private $saveToDir = './data/upload/';

    // Returns path to the directory where we save the image files.
    public function getSaveToDir()
    {
        return $this-&gt;saveToDir;
    }
}
</code></pre>
<p>As you can see from the code above, we define the <code>ImageManager</code> class in line 5. It has the private
<code>$saveToDir</code> property <sup id="fnref:property"><a class="footnote-ref" href="#fn:property">6</a></sup> which contains the path to the directory containing our uploaded
files (line 8) (we store uploaded files in <em>APP_DIR/data/upload</em> directory).</p>
<p>The <code>getSaveToDir()</code> public method (line 11) allows to retrieve the path to the upload directory.</p>
<p>Next, we want to add the <code>getSavedFiles()</code> public method to the service class. The method will scan
the upload directory and return an array containing the names of the uploaded files. To add the
<code>getSavedFiles()</code> method, modify the code in the following way:</p>
<pre><code class="language-php">&lt;?php
//...

// The image manager service.
class ImageManager
{
    //...

    // Returns the array of uploaded file names.
    public function getSavedFiles()
    {
        // The directory where we plan to save uploaded files.

        // Check whether the directory already exists, and if not,
        // create the directory.
        if(!is_dir($this-&gt;saveToDir)) {
            if(!mkdir($this-&gt;saveToDir)) {
                throw new \Exception('Could not create directory for uploads: ' .
                             error_get_last());
            }
        }

        // Scan the directory and create the list of uploaded files.
        $files = [];
        $handle  = opendir($this-&gt;saveToDir);
        while (false !== ($entry = readdir($handle))) {

            if($entry=='.' || $entry=='..')
                continue; // Skip current dir and parent dir.

            $files[] = $entry;
        }

        // Return the list of uploaded files.
        return $files;
    }
}
</code></pre>
<p>In the <code>getSavedFiles()</code> method above, we first check if the upload directory exists (line 16), and if not,
we try to create it (line 17). Then, we get the list of files in the directory (lines 24-32) and
return it to the caller.</p>
<p>Next, we add the three methods for getting information about an uploaded file:</p>
<ul>
<li>
<p>the <code>getImagePathByName()</code> method will take the file name and prepend the path to upload directory
    to that file name;</p>
</li>
<li>
<p>the <code>getImageFileInfo()</code> method will retrieve MIME information about the file and its size in bytes;</p>
</li>
<li>
<p>and the <code>getImageFileContent()</code> will read file data and return them as a string.</p>
</li>
</ul>
<p>To add those three methods, change the code as follows:</p>
<pre><code class="language-php">&lt;?php
//...

// The image manager service.
class ImageManager
{
    //...

    // Returns the path to the saved image file.
    public function getImagePathByName($fileName)
    {
        // Take some precautions to make file name secure.
        $fileName = str_replace(&quot;/&quot;, &quot;&quot;, $fileName);  // Remove slashes.
        $fileName = str_replace(&quot;\\&quot;, &quot;&quot;, $fileName); // Remove back-slashes.

        // Return concatenated directory name and file name.
        return $this-&gt;saveToDir . $fileName;
    }

    // Returns the image file content. On error, returns boolean false.
    public function getImageFileContent($filePath)
    {
        return file_get_contents($filePath);
    }

    // Retrieves the file information (size, MIME type) by image path.
    public function getImageFileInfo($filePath)
    {
        // Try to open file
        if (!is_readable($filePath)) {
            return false;
        }

        // Get file size in bytes.
        $fileSize = filesize($filePath);

        // Get MIME type of the file.
        $finfo = finfo_open(FILEINFO_MIME);
        $mimeType = finfo_file($finfo, $filePath);
        if($mimeType===false)
            $mimeType = 'application/octet-stream';

        return [
            'size' =&gt; $fileSize,
            'type' =&gt; $mimeType
        ];
    }
}
</code></pre>
<p>Finally, we want to add the image resizing functionality to the <code>ImageManager</code> class. The image
resizing functionality will be used for creating small thumbnail images. Add the <code>resizeImage()</code>
method to the <code>ImageManager</code> class as follows:</p>
<pre><code class="language-php">&lt;?php
//...
class ImageManager
{
    //...

    // Resizes the image, keeping its aspect ratio.
    public  function resizeImage($filePath, $desiredWidth = 240)
    {
        // Get original image dimensions.
        list($originalWidth, $originalHeight) = getimagesize($filePath);

        // Calculate aspect ratio
        $aspectRatio = $originalWidth/$originalHeight;
        // Calculate the resulting height
        $desiredHeight = $desiredWidth/$aspectRatio;

        // Get image info
        $fileInfo = $this-&gt;getImageFileInfo($filePath);

        // Resize the image
        $resultingImage = imagecreatetruecolor($desiredWidth, $desiredHeight);
        if (substr($fileInfo['type'], 0, 9) =='image/png')
            $originalImage = imagecreatefrompng($filePath);
        else
            $originalImage = imagecreatefromjpeg($filePath);
        imagecopyresampled($resultingImage, $originalImage, 0, 0, 0, 0,
            $desiredWidth, $desiredHeight, $originalWidth, $originalHeight);

        // Save the resized image to temporary location
        $tmpFileName = tempnam(&quot;/tmp&quot;, &quot;FOO&quot;);
        imagejpeg($resultingImage, $tmpFileName, 80);

        // Return the path to resulting image.
        return $tmpFileName;
    }
}
</code></pre>
<p>The <code>resizeImage()</code> method above takes two arguments: <code>$filePath</code> (the path to the image file),
and <code>$desiredWidth</code> (the width of the thumbnail image). Inside the method, we first calculate
an appropriate thumbnail image height (lines 11-16) preserving its aspect ratio. Then, we resize the
original image as needed and save it to a temporary file (lines 19-32).</p>
<p>As the <code>ImageManager</code> class is ready, you have to register the <code>ImageManager</code> service in the service
manager component of the web application by adding the following lines to the <em>module.config.php</em>
configuration file:</p>
<pre><code class="language-php">&lt;?php
return [
    // ...
    'service_manager' =&gt; [
        // ...
        'factories' =&gt; [
            // Register the ImageManager service
            Service\ImageManager::class =&gt; InvokableFactory::class,
        ],
    ],
    // ...
];
</code></pre>
<h3 id="adding-imagecontroller">Adding ImageController</h3>
<p>For the <em>Image Gallery</em> example, we will create the <code>ImageController</code> controller class. The controller
will have the following action methods (listed in table 10.4):</p>
<table>
<thead>
<tr>
<th><em>Action Method</em></th>
<th><em>Description</em></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__construct()</code></td>
<td>Will allow to inject <code>ImageManager</code> dependency into the controller.</td>
</tr>
<tr>
<td><code>uploadAction()</code></td>
<td>Shows the image upload page allowing to upload a single image.</td>
</tr>
<tr>
<td><code>indexAction()</code></td>
<td>Displays the image gallery page with the list of uploaded images.</td>
</tr>
<tr>
<td><code>fileAction()</code></td>
<td>Provides an ability to download a full-size image or a small thumbnail for an image.</td>
</tr>
</tbody>
</table>
<p>Table 10.4. Action methods of the ImageController class.</p>
<p>To start, create the <em>ImageController.php</em> file in the <em>Application/Controller</em> directory under
the module's source directory. Put the following stub code into the file:</p>
<pre><code class="language-php">&lt;?php
namespace Application\Controller;

use Laminas\Mvc\Controller\AbstractActionController;
use Laminas\View\Model\ViewModel;
use Application\Form\ImageForm;

// This controller is designed for managing image file uploads.
class ImageController extends AbstractActionController
{
    // The image manager.
    private $imageManager;

    // The constructor method is used for injecting the dependencies
    // into the controller.
    public function __construct($imageManager)
    {
        $this-&gt;imageManager = $imageManager;
    }

    // This is the default &quot;index&quot; action of the controller. It displays the
    // Image Gallery page which contains the list of uploaded images.
    public function indexAction()
    {
    }

    // This action shows the image upload form. This page allows to upload
    // a single file.
    public function uploadAction()
    {
    }

    // This is the 'file' action that is invoked when a user wants to
    // open the image file in a web browser or generate a thumbnail.
    public function fileAction()
    {
    }
}
</code></pre>
<p>In the code above, we defined the <code>ImageController</code> class living in the <code>Application\Controller</code>
namespace and added the constructor method and three action method stubs into the class: <code>indexAction()</code>,
<code>uploadAction()</code> and <code>fileAction()</code>. Next, we will populate those action methods
with the code.</p>
<h4 id="adding-upload-action-corresponding-view-template">Adding Upload Action &amp; Corresponding View Template</h4>
<p>First, we will complete the <code>uploadAction()</code> method of our controller. This action method will handle the
<em>Upload a New Image</em> web page containing the upload form. The form will provide an ability to upload an
image file to the gallery.</p>
<p>Change the <em>ImageController.php</em> file as follows:</p>
<pre><code class="language-php">&lt;?php
//...
class ImageController extends AbstractActionController
{
    //...
    public function uploadAction()
    {
        // Create the form model.
        $form = new ImageForm();

        // Check if user has submitted the form.
        if($this-&gt;getRequest()-&gt;isPost()) {

            // Make certain to merge the files info!
            $request = $this-&gt;getRequest();
            $data = array_merge_recursive(
                $request-&gt;getPost()-&gt;toArray(),
                $request-&gt;getFiles()-&gt;toArray()
            );

            // Pass data to form.
            $form-&gt;setData($data);

            // Validate form.
            if($form-&gt;isValid()) {

                // Move uploaded file to its destination directory.
                $data = $form-&gt;getData();

                // Redirect the user to &quot;Image Gallery&quot; page.
                return $this-&gt;redirect()-&gt;toRoute('images');
            }
        }

        // Render the page.
        return new ViewModel([
                     'form' =&gt; $form
                 ]);
    }
}
</code></pre>
<p>In the <code>uploadAction()</code> method above, we do the following.</p>
<p>In line 9, we create an instance of the <code>ImageForm</code> form model with the help of the <code>new</code> operator.</p>
<p>In line 12, we check whether the request is an HTTP POST request. If so, we get the data from <code>$_POST</code>
and <code>$_FILES</code> super-global PHP arrays and merge them into the single array (lines 15-19). This is
required to correctly handle uploaded files, if any. Then we pass this array to the form model with
the <code>setData()</code> method (line 22).</p>
<p>In line 25, we call the form model's <code>isValid()</code> method. This method runs the input filter attached to the form model. Since
we have only one file input in the input filter, this will only run our three file validators:
@<code>UploadFile</code>, @<code>IsImage</code> and @<code>ImageSize</code>.</p>
<p>If the data is valid, we call the <code>getData()</code> method (line 28). For our file field, this will run the
@<code>RenameUpload</code> filter, which moves our uploaded file to its persistent directory.</p>
<p>After that, in line 31, we redirect the user to the "index" action of the controller (we will
populate that action method a little bit later.</p>
<p>Now, its time to add the view template for the "upload" action. Add the <em>upload.phtml</em> view template
file under the <em>application/image</em> directory under the module's <em>view</em> directory:</p>
<pre><code class="language-php">&lt;?php
$form = $this-&gt;form;
$form-&gt;get('submit')-&gt;setAttributes(['class'=&gt;'btn btn-primary']);
$form-&gt;prepare();
?&gt;

&lt;h1&gt;Upload a New Image&lt;/h1&gt;

&lt;p&gt;
    Please fill out the following form and press the &lt;i&gt;Upload&lt;/i&gt; button.
&lt;/p&gt;

&lt;div class=&quot;row&quot;&gt;
    &lt;div class=&quot;col-md-6&quot;&gt;
        &lt;?= $this-&gt;form()-&gt;openTag($form); ?&gt;

        &lt;div class=&quot;form-group&quot;&gt;
            &lt;?= $this-&gt;formLabel($form-&gt;get('file')); ?&gt;
            &lt;?= $this-&gt;formElement($form-&gt;get('file')); ?&gt;
            &lt;?= $this-&gt;formElementErrors($form-&gt;get('file')); ?&gt;
            &lt;div class=&quot;hint&quot;&gt;(PNG and JPG formats are allowed)&lt;/div&gt;
        &lt;/div&gt;

        &lt;?= $this-&gt;formElement($form-&gt;get('submit')); ?&gt;

        &lt;?= $this-&gt;form()-&gt;closeTag(); ?&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>
<p>In the code of the view template, we first set "class" attribute (line 3). This is to
apply nice-looking Twitter Bootstrap styles to the form's <em>Submit</em> button.</p>
<p>Then, we render the form with the common view helpers that we discussed in <a href="#forms">Collecting User Input with Forms</a>.
For rendering the "file" field, we use the generic @<code>FormElement</code> view helper.</p>
<blockquote>
<p>Typically, you use the @<code>FormElement</code> generic view helper for rendering the file field.
The @<code>FormElement</code> internally calls the @<code>FormFile</code> view helper, which performs the actual
rendering.</p>
</blockquote>
<h4 id="adding-index-action-corresponding-view-template">Adding Index Action &amp; Corresponding View Template</h4>
<p>The second action method we will complete is the <code>indexAction()</code>. This action will handle the
<em>Image Gallery</em> page containing the list of uploaded files and their small thumbnails. For each
image, there will be a button "Show In Natural Size" for opening the image in another tab of the web
browser.</p>
<p>Change the <em>ImageController.php</em> file as follows:</p>
<pre><code class="language-php">&lt;?php
//...
class ImageController extends AbstractActionController
{
    //...
    public function indexAction()
    {
        // Get the list of already saved files.
        $files = $this-&gt;imageManager-&gt;getSavedFiles();

        // Render the view template.
        return new ViewModel([
            'files'=&gt;$files
        ]);
    }
}
</code></pre>
<p>In the code above, we use the <code>getSavedFiles()</code> method of the <code>ImageManager</code> class for retrieving
the list of uploaded images and pass them to the view for rendering.</p>
<blockquote>
<p>Please note how "slim" and clear this controller action is! We achieved this by moving the
image management functionality to the <code>ImageManager</code> service model.</p>
</blockquote>
<p>Add the <em>index.phtml</em> view template to <em>application/image</em> directory under the module's
<em>view</em> directory. The contents of the file is shown below:</p>
<pre><code class="language-php">&lt;h1&gt;Image Gallery&lt;/h1&gt;

&lt;p&gt;
  This page displays the list of uploaded images.
&lt;/p&gt;

&lt;p&gt;
  &lt;a href=&quot;&lt;?= $this-&gt;url('images', ['action'=&gt;'upload']); ?&gt;&quot;
     class=&quot;btn btn-primary&quot; role=&quot;button&quot;&gt;Upload More&lt;/a&gt;
&lt;/p&gt;

&lt;hr/&gt;

&lt;?php if(count($files)==0): ?&gt;

&lt;p&gt;
  &lt;i&gt;There are no files to display.&lt;/i&gt;
&lt;/p&gt;

&lt;?php else: ?&gt;

&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col-sm-6 col-md-12&quot;&gt;

    &lt;?php foreach($files as $file): ?&gt;

    &lt;div class=&quot;img-thumbnail&quot;&gt;

      &lt;img src=&quot;&lt;?= $this-&gt;url('images', ['action'=&gt;'file'],
            ['query'=&gt;['name'=&gt;$file, 'thumbnail'=&gt;true]]); ?&gt;&quot;&gt;

      &lt;div class=&quot;caption&quot;&gt;
        &lt;h3&gt;&lt;?php echo $file; ?&gt;&lt;/h3&gt;
        &lt;p&gt;
        &lt;a target=&quot;_blank&quot; href=&quot;&lt;?= $this-&gt;url('images', ['action'=&gt;'file'],
           ['query'=&gt;['name'=&gt;$file]]); ?&gt;&quot;
           class=&quot;btn btn-default&quot; role=&quot;button&quot;&gt;Show in Natural Size&lt;/a&gt;
        &lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;?php endforeach; ?&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;?php endif; ?&gt;

&lt;hr/&gt;
</code></pre>
<p>In the code above, we create the HTML markup for the <em>Upload More</em> button.</p>
<p>Under the button, we use check whether the <code>$files</code> array is empty. If the array is empty,
we output the "There are no files to display" message; otherwise we walk through the files and output
the thumbnails of each uploaded images.</p>
<p>For rendering a thumbnail, we use the <code>&lt;img&gt;</code> tag. We set its <code>src</code> attribute with the URL pointing
to the "file" action of our <code>ImageController</code> controller. We pass two parameters to the action via
the query part of the URL: the image name and thumbnail flag.</p>
<p>For styling the thumbnails, we use the Twitter Bootstrap provided ".img-thumbnail" CSS class.</p>
<blockquote>
<p>For additional information about these Twitter Bootstrap styles, please refer to the
Bootstrap official documentation.</p>
</blockquote>
<p>Below each thumbnail, we put the "Show in Natural Size" link, which points to the "file" action
of our <code>ImageController</code> controller. When site visitor clicks the link, he will be shown with the
image in natural size, and the image will be opened in another browser's tab (note the
<code>target="_blank"</code> attribute of the link).</p>
<h4 id="adding-file-action">Adding File Action</h4>
<p>The last action we will populate is the <code>ImageController::fileAction()</code> method. That method will
allow to preview an uploaded image or generate a small thumbnail of the image. The action method
will take two GET parameters:</p>
<ul>
<li>the "name" parameter defines the file name for preview;</li>
<li>the "thumbnail" parameter is a flag telling whether we want to dump the full image or its small
    copy.</li>
</ul>
<p>Change the <em>ImageController.php</em> file as follows:</p>
<pre><code class="language-php"> &lt;?php
//...
class ImageController extends AbstractActionController
{
    //...
    public function fileAction()
    {
        // Get the file name from GET variable.
        $fileName = $this-&gt;params()-&gt;fromQuery('name', '');

        // Check whether the user needs a thumbnail or a full-size image.
        $isThumbnail = (bool)$this-&gt;params()-&gt;fromQuery('thumbnail', false);

        // Get path to image file.
        $fileName = $this-&gt;imageManager-&gt;getImagePathByName($fileName);

        if($isThumbnail) {

            // Resize the image.
            $fileName = $this-&gt;imageManager-&gt;resizeImage($fileName);
        }

        // Get image file info (size and MIME type).
        $fileInfo = $this-&gt;imageManager-&gt;getImageFileInfo($fileName);
        if ($fileInfo===false) {
            // Set 404 Not Found status code
            $this-&gt;getResponse()-&gt;setStatusCode(404);
            return;
        }

        // Write HTTP headers.
        $response = $this-&gt;getResponse();
        $headers = $response-&gt;getHeaders();
        $headers-&gt;addHeaderLine(&quot;Content-type: &quot; . $fileInfo['type']);
        $headers-&gt;addHeaderLine(&quot;Content-length: &quot; . $fileInfo['size']);

        // Write file content.
        $fileContent = $this-&gt;imageManager-&gt;getImageFileContent($fileName);
        if($fileContent!==false) {
            $response-&gt;setContent($fileContent);
        } else {
            // Set 500 Server Error status code.
            $this-&gt;getResponse()-&gt;setStatusCode(500);
            return;
        }

        if($isThumbnail) {
            // Remove temporary thumbnail image file.
            unlink($fileName);
        }

        // Return Response to avoid default view rendering.
        return $this-&gt;getResponse();
    }
}
</code></pre>
<p>In the code above, we first get the "name" and "thumbnail" parameters from <code>$_GET</code> super-global
array (lines 9, 12). If the parameters are missing, their default values are used instead.</p>
<p>In line 15, we use the <code>getImagePathByName()</code> method provided by the <code>ImageManager</code> service to
get the absolute path to the image by its name.</p>
<p>If a thumbnail is requested, we resize the image with the <code>resizeImage()</code> method of the
<code>ImageManager</code> (line 20). That method returns path to a temporary file containing the thumbnail image.</p>
<p>Then, we get the information about the image file (its MIME type and file size) with the
<code>getImageFileInfo()</code> method of the <code>ImageManager</code> (line 24).</p>
<p>Finally, we create a @<code>Response</code>[Laminas\Http\PhpEnvironment\Response] object, fill its headers with image information,
set its content with data of the image file (lines 32-45), and return the @<code>Response</code>[Laminas\Http\PhpEnvironment\Response] object from the controller
action (line 53).</p>
<blockquote>
<p>Note that returning the @<code>Response</code>[Laminas\Http\PhpEnvironment\Response] object disables the default rendering of the view template for
this action method. By this reason, we do not create the <em>file.phtml</em> view template file.</p>
</blockquote>
<h4 id="creating-factory-for-the-controller">Creating Factory for the Controller</h4>
<p>Because our <code>ImageController</code> uses the <code>ImageManager</code> service, we need to somehow pass it the instance of
the <code>ImageManager</code> (to inject the dependency into the controller's constructor). We do this with the help
of <em>factory</em>.</p>
<p>Create the <code>ImageControllerFactory.php</code> file under the <em>Controller/Factory</em> subdirectory under the module's source
directory. Put the following code into the file:</p>
<pre><code class="language-php">&lt;?php
namespace Application\Controller\Factory;

use Interop\Container\ContainerInterface;
use Laminas\ServiceManager\Factory\FactoryInterface;
use Application\Service\ImageManager;
use Application\Controller\ImageController;

/**
 * This is the factory for ImageController. Its purpose is to instantiate the
 * controller.
 */
class ImageControllerFactory implements FactoryInterface
{
    public function __invoke(ContainerInterface $container,
                        $requestedName, array $options = null)
    {
        $imageManager = $container-&gt;get(ImageManager::class);

        // Instantiate the controller and inject dependencies
        return new ImageController($imageManager);
    }
}
</code></pre>
<h4 id="registering-the-imagecontroller">Registering the ImageController</h4>
<p>To let Laminas know about our controller, register the <code>ImageController</code> in the <em>module.config.php</em> configuration file:</p>
<pre><code class="language-php">&lt;?php
return [
    //...
    'controllers' =&gt; [
        'factories' =&gt; [
            Controller\ImageController::class =&gt;
                    Controller\Factory\ImageControllerFactory::class,
            //...
        ],
    ],
    //...
];
</code></pre>
<h4 id="creating-route">Creating Route</h4>
<p>We need to add a <em>route</em> for our <code>ImageController</code> controller. To do that, modify the <code>module.config.php</code> file
as follows:</p>
<pre><code class="language-php">&lt;?php
return [
    //...
    'router' =&gt; [
        'routes' =&gt; [
            'images' =&gt; [
                'type'    =&gt; Segment::class,
                'options' =&gt; [
                    'route'    =&gt; '/images[/:action]',
                    'constraints' =&gt; [
                        'action' =&gt; '[a-zA-Z][a-zA-Z0-9_-]*'
                    ],
                    'defaults' =&gt; [
                        'controller'    =&gt; Controller\ImageController::class,
                        'action'        =&gt; 'index',
                    ],
                ],
            ],
        ],
    ],
    //...
];
</code></pre>
<p>After that, you will be able to get access to our image gallery by the URL like "http://localhost/images",
"http://localhost/images/upload" or "http://localhost/images/file".</p>
<h3 id="results">Results</h3>
<p>Finally, adjust directory permissions to make the <em>APP_DIR/data</em> directory writeable by the Apache Web Server.
In Linux Ubuntu, this is typically accomplished by the following shell commands (replace the <code>APP_DIR</code>
placeholder with the actual directory name of your web application):</p>
<p><code>chown -R www-data:www-data APP_DIR/data</code></p>
<p><code>chmod -R 775 APP_DIR/data</code></p>
<p>Above, the <code>chown</code> and <code>chmod</code> commands set the Apache user to be the owner of the directory and
allow the web server to write to the directory, respectively.</p>
<p>If you now enter the URL <em>http://localhost/images</em> into your web browser's
navigation bar, you will see the image gallery page like shown in figure 10.4.</p>
<p>{width=80%}
<img alt="Figure 10.4. Image Gallery Page" src="../images/uploads/empty_image_gallery.png" /></p>
<p>Clicking the <em>Upload More</em> button will open the <em>Upload a New Image</em> page where you can peek an image file
for upload. If you pick an unacceptable file (not an image, or too big image), you will see validation
errors (see the figure 10.5 below).</p>
<p>{width=80%}
<img alt="Figure 10.5. File Validation Errors" src="../images/uploads/image_validation_errors.png" /></p>
<p>If the upload is completed successfully, you will be redirected back to the <em>Image Gallery</em> page
and see the uploaded image in the list of thumbnails. Clicking the <em>View Full Size</em> button will
open the image in a new browser tab (see the figure 10.6 below for example).</p>
<p>{width=80%}
<img alt="Figure 10.6. Opening an Image in Natural Size" src="../images/uploads/image_preview.png" /></p>
<blockquote>
<p>You may find the <em>Image Gallery</em> complete example in the <em>Form Demo</em> sample web application
bundled with this book.</p>
</blockquote>
<h2 id="summary">Summary</h2>
<p>File uploads is a standard HTML form feature. Uploading files is accomplished by setting form
content encoding to binary encoding type. Laminas Framework provides convenient functionality
for doing file uploads and validating the uploaded files.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:rfc-1867">
<p>HTTP file uploads are described in <a href="http://www.ietf.org/rfc/rfc1867.txt">RFC-1867</a>. This mechanism
         allows to upload large files by using binary content transfer
         encoding. The "multipart/form-data" encoding type is utilized
         for this purpose.&#160;<a class="footnote-backref" href="#fnref:rfc-1867" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:get">
<p>The HTTP GET method is inefficient for file uploads, because URL length has some
    upper limit. Also, URL-encoding the file data greatly increases the URL length.&#160;<a class="footnote-backref" href="#fnref:get" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:mime">
<p>MIME type, also known as "content type" is a standard identifier used on the
     Internet to indicate the type of data that a file contains. For example the "text/plain"
     MIME type is assigned to a text file, while the "application/octet-stream" MIME type
     is assigned to a binary file.&#160;<a class="footnote-backref" href="#fnref:mime" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:hash">
<p>A file hash is used for checking file data integrity (for example, to ensure that
     file data is not corrupted). There are several hash algorithms available (MD5, SHA-1, CRC32, etc.)&#160;<a class="footnote-backref" href="#fnref:hash" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:four">
<p>In the author's opinion, the above mentioned four filters are not very useful when working
     with uploaded files, because you rarely need to encrypt an uploaded file or convert it to
     lower case letters.&#160;<a class="footnote-backref" href="#fnref:four" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:property">
<p>Although the <code>ImageManager</code> class is a service and focused on providing services,
         it can have properties intended for its internal use.&#160;<a class="footnote-backref" href="#fnref:property" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
</ol>
</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../validators/" class="btn btn-neutral float-left" title="Checking Input Data with Validators"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../forms_advanced/" class="btn btn-neutral float-right" title="Advanced Usage of Forms">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/modir/laminas-book" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../validators/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../forms_advanced/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
